<?php
class menuTreeController extends base{}
require_once 'app/common.php';
#nocache();

/**
 * CrÃ©ation arborescence des menus
 */

function to_tree($childs2parent, $listOfParents = [0], $menuData = [], $trimNonPresentParents = 1)
{
    $flat = $tree = [];
    foreach ($childs2parent as $child => $parent) {
        #ignore cause hidden or non present parent : trim hidden menus items
        if ($trimNonPresentParents and $parent and $listOfParents and !in_array($parent, $listOfParents)) {
            continue;
        }
        if (!isset($flat[$child])) {#leaf non created yet
            if (isset($menuData[$child])) {
                $flat[$child] = $menuData[$child];
            } else {
                $flat[$child] = [];
            }
            $a = 1;
        }
        if (!empty($parent)) {#imbrication dedans
            $flat[$parent]['childrens'][$child] =& $flat[$child];
            if (isset($menuData[$parent])) {
                $flat[$parent] = array_merge($flat[$parent], $menuData[$parent]);
            }
            $a = 1;
        } else {
            $tree[$child] =& $flat[$child];
            $a = 1;
        }
    }
    #common trunk
    if (!$tree) {
        $tree = [0 => ['childrens' => $flat]];
    }
    return $tree;
}

define('_DOMAIN_ID_', '8');
define('_LANG_', 'us');
$req = "
SELECT m.menus_id,m.menus_code,mi.menuitems_id as mid,mi.parents_id as pid,mi.menuitems_format,mi.menuitems_visible,mi.menuitems_active,mi.menuitems_bd,mi.menuitems_bg,mi.menuitems_cliquable,mit.menuitems_target,mit.menuitems_libellemenu as label,plt.permaliens_lien as url
 FROM domaines_diffusion diff
-- 
 INNER JOIN menus m ON m.menus_id = diff.instances_id AND m.menus_active='Y' AND m.menus_code in('MENU','FOOTER') 
 INNER JOIN menus_translation met ON m.menus_id = met.menus_id AND met.lang = '" . _LANG_ . "'
 INNER JOIN menus_translation t ON m.menus_id = t.menus_id AND t.lang = '" . _LANG_ . "'
 INNER JOIN menuitems mi ON m.menus_id = mi.menus_id and mi.menuitems_visible= 'Y' and mi.menuitems_active = 'Y' and (mi.menuitems_catalogue='public' or  mi.menuitems_catalogue is null)
 INNER JOIN menuitems_translation mit ON mi.menuitems_id = mit.menuitems_id AND mit.lang = '" . _LANG_ . "' AND mit.menuitems_libellemenu is not null
 INNER JOIN permaliens pl ON mi.permaliens_id = pl.permaliens_id 
 INNER JOIN permaliens_translation plt ON pl.permaliens_id = plt.permaliens_id AND plt.lang = '" . _LANG_ . "'  AND plt.permaliens_lien is not null
-- lots of stuff here
 where diff.domaines_id = " . _DOMAIN_ID_ . " AND diff.instances_type = 'menus' AND diff.domaines_diffusion_active = 'Y' 
 ORDER BY m.menus_ordre ASC, mi.menuitems_bg";
$a = 1;
#$allMenuItems = sql5($req, 0, 'utf8');#returns array of mysqli_fetch_assoc
$allMenuItems = json_decode(
    '[{"menus_id":"5","menus_code":"MENU","mid":"1062","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"2","menuitems_bg":"1","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Covid-19","url":"covid-19\/"},{"menus_id":"5","menus_code":"MENU","mid":"220","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"56","menuitems_bg":"23","menuitems_cliquable":"N","menuitems_target":"_self","label":"Epilation","url":"epilation\/"},{"menus_id":"5","menus_code":"MENU","mid":"231","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"29","menuitems_bg":"28","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Cires sans bande","url":"epilation\/cires-sans-bande\/"},{"menus_id":"5","menus_code":"MENU","mid":"230","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"31","menuitems_bg":"30","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Cires avec bandes","url":"epilation\/cires-avec-bandes\/"},{"menus_id":"5","menus_code":"MENU","mid":"930","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"33","menuitems_bg":"32","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Epilation au sucre SugarExpert","url":"epilation\/epilation-au-sucre-sugar-expert\/"},{"menus_id":"5","menus_code":"MENU","mid":"225","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"35","menuitems_bg":"34","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Gamme Tendre Coton","url":"epilation\/gamme-tendre-coton\/"},{"menus_id":"5","menus_code":"MENU","mid":"229","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"37","menuitems_bg":"36","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Cartouches de cire","url":"epilation\/cartouches-de-cire\/"},{"menus_id":"5","menus_code":"MENU","mid":"228","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"39","menuitems_bg":"38","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Cire \u00e0 \u00e9piler traditionnelle","url":"epilation\/cire-a-epiler-traditionnelle\/"},{"menus_id":"5","menus_code":"MENU","mid":"974","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"41","menuitems_bg":"40","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Cire \u00e0 \u00e9piler - Autres marques","url":"epilation\/cire-a-epiler-autres-marques\/"},{"menus_id":"5","menus_code":"MENU","mid":"227","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"43","menuitems_bg":"42","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Cire \u00e0 \u00e9piler Pil\u00e9pil\u00ae","url":"epilation\/cire-a-epiler-pilepil\/"},{"menus_id":"5","menus_code":"MENU","mid":"224","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"49","menuitems_bg":"44","menuitems_cliquable":"N","menuitems_target":"_self","label":"Soins pr\u00e9\/post-\u00e9pilation","url":"epilation\/soins-prepost-epilation\/"},{"menus_id":"5","menus_code":"MENU","mid":"586","pid":"224","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"46","menuitems_bg":"45","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins pr\u00e9-\u00e9pilation","url":"epilation\/soins-prepost-epilation\/soins-pre-epilation\/"},{"menus_id":"5","menus_code":"MENU","mid":"587","pid":"224","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"48","menuitems_bg":"47","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins post-\u00e9pilation","url":"epilation\/soins-prepost-epilation\/soins-post-epilation\/"},{"menus_id":"5","menus_code":"MENU","mid":"223","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"51","menuitems_bg":"50","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Accessoires","url":"epilation\/accessoires\/"},{"menus_id":"5","menus_code":"MENU","mid":"221","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"53","menuitems_bg":"52","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Appareils \u00e0 cires","url":"epilation\/appareils-a-cires\/"},{"menus_id":"5","menus_code":"MENU","mid":"770","pid":"220","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"55","menuitems_bg":"54","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Affiches, posters, pr\u00e9sentoirs","url":"epilation\/affiches-posters-presentoirs\/"},{"menus_id":"5","menus_code":"MENU","mid":"768","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"94","menuitems_bg":"57","menuitems_cliquable":"N","menuitems_target":"_self","label":"Beaut\u00e9 des ongles","url":"beaute-des-ongles\/"},{"menus_id":"5","menus_code":"MENU","mid":"1022","pid":"768","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"67","menuitems_bg":"58","menuitems_cliquable":"N","menuitems_target":"_self","label":"Kinetics","url":"beaute-des-ongles\/kinetics\/"},{"menus_id":"5","menus_code":"MENU","mid":"1023","pid":"1022","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"60","menuitems_bg":"59","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Vernis SOLARGEL","url":"beaute-des-ongles\/kinetics\/vernis-solargel\/"},{"menus_id":"5","menus_code":"MENU","mid":"1024","pid":"1022","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"62","menuitems_bg":"61","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Vernis SHIELD GEL POLISH semi-permanent","url":"beaute-des-ongles\/kinetics\/vernis-shield-gel-polish-semi-permanent\/"},{"menus_id":"5","menus_code":"MENU","mid":"1026","pid":"1022","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"64","menuitems_bg":"63","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Les Gels UV","url":"beaute-des-ongles\/kinetics\/les-gels-uv\/"},{"menus_id":"5","menus_code":"MENU","mid":"1007","pid":"768","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"79","menuitems_bg":"68","menuitems_cliquable":"N","menuitems_target":"_self","label":"Manucurist","url":"beaute-des-ongles\/manucurist\/"},{"menus_id":"5","menus_code":"MENU","mid":"1017","pid":"1007","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"70","menuitems_bg":"69","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins protecteurs et r\u00e9parateurs","url":"beaute-des-ongles\/manucurist\/soins-protecteurs-et-reparateurs\/"},{"menus_id":"5","menus_code":"MENU","mid":"1011","pid":"1007","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"72","menuitems_bg":"71","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Gamme GREEN FLASH","url":"beaute-des-ongles\/manucurist\/gamme-green-flash\/"},{"menus_id":"5","menus_code":"MENU","mid":"1010","pid":"1007","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"74","menuitems_bg":"73","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Gamme GREEN Vernis et soins naturels","url":"beaute-des-ongles\/manucurist\/gamme-green-vernis-et-soins-naturels\/"},{"menus_id":"5","menus_code":"MENU","mid":"1013","pid":"1007","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"76","menuitems_bg":"75","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Permanentlac - Vernis gel semi-permanent","url":"beaute-des-ongles\/manucurist\/permanentlac-vernis-gel-semi-permanent\/"},{"menus_id":"5","menus_code":"MENU","mid":"1015","pid":"1007","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"78","menuitems_bg":"77","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Vernis enfants Petite Manucurist","url":"beaute-des-ongles\/manucurist\/vernis-enfants-petite-manucurist\/"},{"menus_id":"5","menus_code":"MENU","mid":"943","pid":"768","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"85","menuitems_bg":"84","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Vernis \u00e0 ongles Le Club des Professionnels","url":"beaute-des-ongles\/vernis-a-ongles-le-club-des-professionnels\/"},{"menus_id":"5","menus_code":"MENU","mid":"773","pid":"768","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"87","menuitems_bg":"86","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins et traitements pour les ongles","url":"beaute-des-ongles\/soins-et-traitements-pour-les-ongles\/"},{"menus_id":"5","menus_code":"MENU","mid":"829","pid":"768","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"89","menuitems_bg":"88","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Accessoires et appareils","url":"beaute-des-ongles\/accessoires-et-appareils\/"},{"menus_id":"5","menus_code":"MENU","mid":"774","pid":"768","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"93","menuitems_bg":"92","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Affiches, posters, pr\u00e9sentoirs","url":"beaute-des-ongles\/affiches-posters-presentoirs\/"},{"menus_id":"5","menus_code":"MENU","mid":"161","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"176","menuitems_bg":"95","menuitems_cliquable":"N","menuitems_target":"_self","label":"Soins visage et corps","url":"soins-visage-et-corps\/"},{"menus_id":"5","menus_code":"MENU","mid":"196","pid":"161","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"111","menuitems_bg":"96","menuitems_cliquable":"N","menuitems_target":"_self","label":"Soins visage","url":"soins-visage-et-corps\/soins-visage\/"},{"menus_id":"5","menus_code":"MENU","mid":"208","pid":"196","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"98","menuitems_bg":"97","menuitems_cliquable":"Y","menuitems_target":"_self","label":"NOVEXPERT","url":"soins-visage-et-corps\/soins-visage\/novexpert\/"},{"menus_id":"5","menus_code":"MENU","mid":"996","pid":"196","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"100","menuitems_bg":"99","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Oligodermie","url":"soins-visage-et-corps\/soins-visage\/oligodermie\/"},{"menus_id":"5","menus_code":"MENU","mid":"216","pid":"196","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"102","menuitems_bg":"101","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Skin hydra lumi\u00e8re","url":"soins-visage-et-corps\/soins-visage\/skin-hydra-lumiere\/"},{"menus_id":"5","menus_code":"MENU","mid":"215","pid":"196","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"104","menuitems_bg":"103","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Age gold repair","url":"soins-visage-et-corps\/soins-visage\/age-gold-repair\/"},{"menus_id":"5","menus_code":"MENU","mid":"936","pid":"196","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"106","menuitems_bg":"105","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Le Club des Professionnels","url":"soins-visage-et-corps\/soins-visage\/le-club-des-professionnels\/"},{"menus_id":"5","menus_code":"MENU","mid":"199","pid":"196","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"110","menuitems_bg":"109","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Feuilles de collag\u00e8ne et ampoules","url":"soins-visage-et-corps\/soins-visage\/feuilles-de-collagene-et-ampoules\/"},{"menus_id":"5","menus_code":"MENU","mid":"188","pid":"161","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"121","menuitems_bg":"112","menuitems_cliquable":"N","menuitems_target":"_self","label":"Soins corps","url":"soins-visage-et-corps\/soins-corps\/"},{"menus_id":"5","menus_code":"MENU","mid":"977","pid":"188","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"114","menuitems_bg":"113","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Le Club des Professionnels","url":"soins-visage-et-corps\/soins-corps\/le-club-des-professionnels\/"},{"menus_id":"5","menus_code":"MENU","mid":"192","pid":"188","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"116","menuitems_bg":"115","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Body Glam Rituals","url":"soins-visage-et-corps\/soins-corps\/body-glam-rituals\/"},{"menus_id":"5","menus_code":"MENU","mid":"191","pid":"188","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"118","menuitems_bg":"117","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Jardin dOrient","url":"soins-visage-et-corps\/soins-corps\/jardin-d-orient\/"},{"menus_id":"5","menus_code":"MENU","mid":"1004","pid":"188","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"120","menuitems_bg":"119","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Teinture zones intimes","url":"soins-visage-et-corps\/soins-corps\/teinture-zones-intimes\/"},{"menus_id":"5","menus_code":"MENU","mid":"180","pid":"161","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"133","menuitems_bg":"122","menuitems_cliquable":"N","menuitems_target":"_self","label":"Mains &amp; Pieds","url":"soins-visage-et-corps\/mains-pieds\/"},{"menus_id":"5","menus_code":"MENU","mid":"973","pid":"180","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"124","menuitems_bg":"123","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins mains et pieds \u00e0 usage unique VOESH","url":"soins-visage-et-corps\/mains-pieds\/soins-mains-et-pieds-a-usage-unique-voesh\/"},{"menus_id":"5","menus_code":"MENU","mid":"187","pid":"180","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"126","menuitems_bg":"125","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins pour les mains","url":"soins-visage-et-corps\/mains-pieds\/soins-pour-les-mains\/"},{"menus_id":"5","menus_code":"MENU","mid":"186","pid":"180","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"128","menuitems_bg":"127","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins pour les pieds","url":"soins-visage-et-corps\/mains-pieds\/soins-pour-les-pieds\/"},{"menus_id":"5","menus_code":"MENU","mid":"185","pid":"180","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"130","menuitems_bg":"129","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Calluspeeling\u00ae","url":"soins-visage-et-corps\/mains-pieds\/calluspeeling\/"},{"menus_id":"5","menus_code":"MENU","mid":"835","pid":"180","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"132","menuitems_bg":"131","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Outils et accessoires","url":"soins-visage-et-corps\/mains-pieds\/outils-et-accessoires\/"},{"menus_id":"5","menus_code":"MENU","mid":"1063","pid":"161","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"135","menuitems_bg":"134","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins et accessoires pour homme","url":"soins-visage-et-corps\/soins-et-accessoires-pour-homme\/"},{"menus_id":"5","menus_code":"MENU","mid":"832","pid":"161","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"137","menuitems_bg":"136","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Mat\u00e9riels et consommables","url":"soins-visage-et-corps\/materiels-et-consommables\/"},{"menus_id":"5","menus_code":"MENU","mid":"1020","pid":"161","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"139","menuitems_bg":"138","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Appareils revente","url":"soins-visage-et-corps\/appareils-revente\/"},{"menus_id":"5","menus_code":"MENU","mid":"149","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"200","menuitems_bg":"177","menuitems_cliquable":"N","menuitems_target":"_self","label":"Regard","url":"regard\/"},{"menus_id":"5","menus_code":"MENU","mid":"963","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"179","menuitems_bg":"178","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Maquillage","url":"regard\/maquillage\/"},{"menus_id":"5","menus_code":"MENU","mid":"152","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"181","menuitems_bg":"180","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Extensions de cils","url":"regard\/extensions-de-cils\/"},{"menus_id":"5","menus_code":"MENU","mid":"155","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"183","menuitems_bg":"182","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Faux cils magn\u00e9tiques","url":"regard\/faux-cils-magnetiques\/"},{"menus_id":"5","menus_code":"MENU","mid":"993","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"189","menuitems_bg":"184","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Faux cils \u00e0 coller","url":"regard\/faux-cils-a-coller\/"},{"menus_id":"5","menus_code":"MENU","mid":"1006","pid":"993","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"186","menuitems_bg":"185","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Lash Perfect LASH POPS","url":"regard\/faux-cils-a-coller\/lash-perfect-lash-pops\/"},{"menus_id":"5","menus_code":"MENU","mid":"1005","pid":"993","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"188","menuitems_bg":"187","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Lash Perfect IN A STRIP","url":"regard\/faux-cils-a-coller\/lash-perfect-in-a-strip\/"},{"menus_id":"5","menus_code":"MENU","mid":"160","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"191","menuitems_bg":"190","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Teinture cils\/sourcils","url":"regard\/teinture-cilssourcils\/"},{"menus_id":"5","menus_code":"MENU","mid":"159","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"193","menuitems_bg":"192","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Permanente cils","url":"regard\/permanente-cils\/"},{"menus_id":"5","menus_code":"MENU","mid":"158","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"195","menuitems_bg":"194","menuitems_cliquable":"Y","menuitems_target":"_self","label":"R\u00e9haussement cils","url":"regard\/rehaussement-cils\/"},{"menus_id":"5","menus_code":"MENU","mid":"156","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"197","menuitems_bg":"196","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Soins et accessoires Cils\/Sourcils","url":"regard\/soins-et-accessoires-cilssourcils\/"},{"menus_id":"5","menus_code":"MENU","mid":"771","pid":"149","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"199","menuitems_bg":"198","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Affiches, posters et pr\u00e9sentoirs","url":"regard\/affiches-posters-et-presentoirs\/"},{"menus_id":"5","menus_code":"MENU","mid":"109","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"234","menuitems_bg":"201","menuitems_cliquable":"N","menuitems_target":"_self","label":"Mat\u00e9riel Cabine","url":"materiel-cabine\/"},{"menus_id":"5","menus_code":"MENU","mid":"745","pid":"109","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"203","menuitems_bg":"202","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Fauteuils et tables de soins","url":"materiel-cabine\/fauteuils-et-tables-de-soins\/"},{"menus_id":"5","menus_code":"MENU","mid":"776","pid":"109","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"205","menuitems_bg":"204","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Petit mobilier","url":"materiel-cabine\/petit-mobilier\/"},{"menus_id":"5","menus_code":"MENU","mid":"775","pid":"109","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"207","menuitems_bg":"206","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Mobilier bois","url":"materiel-cabine\/mobilier-bois\/"},{"menus_id":"5","menus_code":"MENU","mid":"778","pid":"109","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"217","menuitems_bg":"208","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Appareils de soins","url":"materiel-cabine\/appareils-de-soins\/"},{"menus_id":"5","menus_code":"MENU","mid":"781","pid":"778","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"210","menuitems_bg":"209","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Appareils visage et corps","url":"materiel-cabine\/appareils-de-soins\/appareils-visage-et-corps\/"},{"menus_id":"5","menus_code":"MENU","mid":"783","pid":"778","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"212","menuitems_bg":"211","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Appareils \u00e0 ozone","url":"materiel-cabine\/appareils-de-soins\/appareils-a-ozone\/"},{"menus_id":"5","menus_code":"MENU","mid":"780","pid":"778","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"214","menuitems_bg":"213","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Couvertures et matelas chauffants","url":"materiel-cabine\/appareils-de-soins\/couvertures-et-matelas-chauffants\/"},{"menus_id":"5","menus_code":"MENU","mid":"779","pid":"778","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"216","menuitems_bg":"215","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Lampes","url":"materiel-cabine\/appareils-de-soins\/lampes\/"},{"menus_id":"5","menus_code":"MENU","mid":"116","pid":"109","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"231","menuitems_bg":"218","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Consommables","url":"materiel-cabine\/consommables\/"},{"menus_id":"5","menus_code":"MENU","mid":"123","pid":"116","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"220","menuitems_bg":"219","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Linge blanc","url":"materiel-cabine\/consommables\/linge-blanc\/"},{"menus_id":"5","menus_code":"MENU","mid":"122","pid":"116","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"222","menuitems_bg":"221","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Linge couleur","url":"materiel-cabine\/consommables\/linge-couleur\/"},{"menus_id":"5","menus_code":"MENU","mid":"121","pid":"116","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"224","menuitems_bg":"223","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Linge jetable","url":"materiel-cabine\/consommables\/linge-jetable\/"},{"menus_id":"5","menus_code":"MENU","mid":"120","pid":"116","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"226","menuitems_bg":"225","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Draps de soins","url":"materiel-cabine\/consommables\/draps-de-soins\/"},{"menus_id":"5","menus_code":"MENU","mid":"119","pid":"116","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"228","menuitems_bg":"227","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Accessoires","url":"materiel-cabine\/consommables\/accessoires\/"},{"menus_id":"5","menus_code":"MENU","mid":"118","pid":"116","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"230","menuitems_bg":"229","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Hygi\u00e8ne","url":"materiel-cabine\/consommables\/hygiene\/"},{"menus_id":"5","menus_code":"MENU","mid":"777","pid":"109","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"233","menuitems_bg":"232","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Bougies et sprays parfum\u00e9s","url":"materiel-cabine\/bougies-et-sprays-parfumes\/"},{"menus_id":"5","menus_code":"MENU","mid":"106","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"248","menuitems_bg":"235","menuitems_cliquable":"N","menuitems_target":"_self","label":"Kits &amp; Sacs","url":"kits-sacs\/"},{"menus_id":"5","menus_code":"MENU","mid":"108","pid":"106","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"243","menuitems_bg":"236","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Kits","url":"kits-sacs\/kits\/"},{"menus_id":"5","menus_code":"MENU","mid":"572","pid":"108","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"238","menuitems_bg":"237","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Kits cires","url":"kits-sacs\/kits\/kits-cires\/"},{"menus_id":"5","menus_code":"MENU","mid":"573","pid":"108","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"240","menuitems_bg":"239","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Kits soins","url":"kits-sacs\/kits\/kits-soins\/"},{"menus_id":"5","menus_code":"MENU","mid":"690","pid":"108","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"242","menuitems_bg":"241","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Kit Extension de cils","url":"kits-sacs\/kits\/kit-extension-de-cils\/"},{"menus_id":"5","menus_code":"MENU","mid":"107","pid":"106","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"245","menuitems_bg":"244","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Bagagerie","url":"kits-sacs\/bagagerie\/"},{"menus_id":"5","menus_code":"MENU","mid":"772","pid":"106","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"247","menuitems_bg":"246","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Sacs revente","url":"kits-sacs\/sacs-revente\/"},{"menus_id":"5","menus_code":"MENU","mid":"952","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"256","menuitems_bg":"249","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Formation","url":"formation\/"},{"menus_id":"5","menus_code":"MENU","mid":"958","pid":"952","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"251","menuitems_bg":"250","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Calendrier des formations","url":"formation\/calendrier-des-formations\/"},{"menus_id":"5","menus_code":"MENU","mid":"954","pid":"952","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"253","menuitems_bg":"252","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Formation \u00e9pilation au sucre","url":"formation\/formation-epilation-au-sucre\/"},{"menus_id":"5","menus_code":"MENU","mid":"953","pid":"952","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"255","menuitems_bg":"254","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Formation cr\u00e9ateur de regard","url":"formation\/formation-createur-de-regard\/"},{"menus_id":"5","menus_code":"MENU","mid":"83","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"294","menuitems_bg":"257","menuitems_cliquable":"N","menuitems_target":"_self","label":"Coaching","url":"coaching\/"},{"menus_id":"5","menus_code":"MENU","mid":"884","pid":"83","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"259","menuitems_bg":"258","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Le choix du partenaire","url":"coaching\/le-choix-du-partenaire\/"},{"menus_id":"5","menus_code":"MENU","mid":"763","pid":"83","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"261","menuitems_bg":"260","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Remise \u00e0 niveau","url":"coaching\/remise-a-niveau\/"},{"menus_id":"5","menus_code":"MENU","mid":"795","pid":"83","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"263","menuitems_bg":"262","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Nos vid\u00e9os","url":"coaching\/nos-videos\/"},{"menus_id":"5","menus_code":"MENU","mid":"796","pid":"83","menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"291","menuitems_bg":"264","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Documents utiles","url":"coaching\/documents-utiles\/"},{"menus_id":"5","menus_code":"MENU","mid":"232","pid":null,"menuitems_format":"big_submenu","menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"296","menuitems_bg":"295","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Promos","url":"promos\/"},{"menus_id":"4","menus_code":"FOOTER","mid":"787","pid":null,"menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"10","menuitems_bg":"9","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Qui sommes-nous ?","url":"qui-sommes-nous\/"},{"menus_id":"4","menus_code":"FOOTER","mid":"788","pid":null,"menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"20","menuitems_bg":"11","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Aide \/ FAQ","url":"aide-faq\/"},{"menus_id":"4","menus_code":"FOOTER","mid":"22","pid":null,"menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"26","menuitems_bg":"23","menuitems_cliquable":"Y","menuitems_target":"_self","label":"Contact","url":"contact\/"},{"menus_id":"4","menus_code":"FOOTER","mid":"31","pid":null,"menuitems_format":null,"menuitems_visible":"Y","menuitems_active":"Y","menuitems_bd":"44","menuitems_bg":"43","menuitems_cliquable":"Y","menuitems_target":"_self","label":"CGU\/CGV","url":"cgucgv\/"}]',
    1
);
$menuData = $listOfParents = $child2parent = [];
foreach ($allMenuItems as $t) {
    $menuData[$t['mid']] = $t;
    $listOfParents[] = $t['mid'];
    if ($t['pid']) {
        $child2parent[$t['mid']] = $t['pid'];
    }
}
$arborescence = to_tree($child2parent, $listOfParents, $menuData)[0];#from the trunk

function _recursiveMenu($arborescence, $lv = 0)
{
    $ret = '';
    $pad = str_repeat("\t", $lv);
    if (isset($arborescence['label'])) {
        $ret .= "\n$pad<li>" . $arborescence['label'];
    }
    #while not final node
    if (isset($arborescence['childrens'])) {
        $ret .= "\n$pad<ul>";
        foreach ($arborescence['childrens'] as $child) {
            $ret .= _recursiveMenu($child, $lv + 1);
        }
        $ret .= "\n$pad</ul>";
    }
    $ret .= "</li>";
    return $ret;
}

$title='menutree';
require_once 'z/header.php';
echo _recursiveMenu($arborescence);
return;
